
---
title: "Доказательство локальных минимумов функции"
output: html_document
---

```{r setup, include=FALSE}
# Устанавливаем и подключаем pacman (если еще не установлен)
if (!requireNamespace("pacman", quietly = TRUE)) install.packages("pacman")
library(pacman)

# Проверяем и загружаем необходимые библиотеки с помощью pacman::p_load
pacman::p_load(Deriv, ggplot2, plotly, viridis)
```

# Введение

В этом упражнении мы найдем и проверим локальные минимумы функции:

$$
f(x) = x^3 + 3x^2 - 3x + 4
$$

Для нахождения экстремумов функции вычислим её первую и вторую производные, а также проверим значения в критических точках.

# Первая производная

Найдём первую производную функции, чтобы найти её критические точки. Первая производная задаётся как:

$$
\frac{df}{dx} = 3x^2 + 6x - 3
$$

Приравнивая первую производную к нулю, находим критические точки функции.

# Вторая производная

Для определения характера критических точек, вычислим вторую производную:

$$
\frac{d^2f}{dx^2} = 6x + 6
$$

Если значение второй производной положительно в критической точке, то эта точка является минимумом, если отрицательно — максимумом.

# Вычисление производных с помощью библиотеки `Deriv`

Теперь проверим наши декларации, вычислив производные с помощью библиотеки `Deriv` в R.

```{r derivatives, message=FALSE}
# Определяем функцию
f <- function(x) {
  x^3 + 3 * x^2 - 3 * x + 4
}

# Первая и вторая производные
df_dx <- Deriv(f, "x")
d2f_dx2 <- Deriv(df_dx, "x")

# Выводим вычисленные производные
list(
  Первая_производная = df_dx,
  Вторая_производная = d2f_dx2
)
```

# Проверка значений производных в критических точках

Решим уравнение \( \frac{df}{dx} = 0 \) для нахождения критических точек. Подставим найденные значения в \( \frac{d^2f}{dx^2} \), чтобы определить характер критических точек.

```{r critical-points}
# Находим критические точки
critical_points <- polyroot(c(-3, 6, 3))
critical_points_real <- Re(critical_points) # только действительные части

# Проверка значений второй производной в критических точках
second_derivative_values <- sapply(critical_points_real, function(x) d2f_dx2(x))

# Выводим результаты
data.frame(
  Критические_точки = critical_points_real,
  Вторая_производная = second_derivative_values,
  Минимум = second_derivative_values > 0
)
```

В результате таблицы видно, какие из критических точек являются локальными минимумами (где вторая производная положительна).

# Визуализация функции

Для лучшего понимания поведения функции построим её график вместе с найденными критическими точками.

```{r plot, echo=FALSE}
# Создаем значения для x и y
x_vals <- seq(-3, 3, length.out = 100)
y_vals <- sapply(x_vals, f)

# Создаем data.frame для функции и критических точек
function_data <- data.frame(x = x_vals, y = y_vals)
critical_points_data <- data.frame(
  x = critical_points_real,
  y = sapply(critical_points_real, f)
)

# График функции с критическими точками
ggplot(function_data, aes(x = x, y = y)) +
  geom_line(color = "blue") +
  geom_point(data = critical_points_data, aes(x = x, y = y), color = "red", size = 2) +
  labs(title = "График функции f(x) = x^3 + 3x^2 - 3x + 4", x = "x", y = "f(x)") +
  theme_minimal()
```

# Выводы

На основе анализа производных и визуализации мы определили, что критические точки функции \( f(x) = x^3 + 3x^2 - 3x + 4 \) соответствуют локальным минимумам, так как в этих точках вторая производная положительна.

Таким образом, мы успешно подтвердили, что эти точки являются локальными минимумами функции.
