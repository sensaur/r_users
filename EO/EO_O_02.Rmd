
---
title: "Вычисление градиента и гессиана для функций"
output: html_document
---

```{r setup, include=FALSE}
# Устанавливаем и подключаем pacman (если еще не установлен)
if (!requireNamespace("pacman", quietly = TRUE)) install.packages("pacman")
library(pacman)

# Проверяем и загружаем необходимые библиотеки с помощью pacman::p_load
pacman::p_load(Deriv, matrixcalc)
```

# Введение

В этом упражнении мы вычислим градиент и гессиан для двух функций:

1. \( f_1(x) = a^T x \)
2. \( f_2(x) = x^T A x \)

где \( x \) — это вектор размерности \( n \), \( a \) — это вектор размерности \( n \), и \( A \) — симметричная матрица размера \( n 	imes n \).

# Градиент и гессиан функции \( f_1(x) = a^T x \)

## Градиент функции \( f_1(x) \)

Для линейной функции \( f_1(x) = a^T x \) градиентом является вектор \( a \).

```{r}
# Определяем вектор a и функцию f1
a <- c(1, 2, 3) # пример вектора a
f1 <- function(x) {
  sum(a * x)
}

# Вычисляем градиент функции f1 по каждому элементу x
grad_f1 <- Deriv(f1, "x")
grad_f1
```

## Гессиан функции \( f_1(x) \)

Так как \( f_1(x) \) — линейная функция, её гессиан является матрицей нулей.

```{r}
# Гессиан функции f1
hessian_f1 <- matrix(0, nrow = length(a), ncol = length(a))
hessian_f1
```

# Градиент и гессиан функции \( f_2(x) = x^T A x \)

## Градиент функции \( f_2(x) \)

Для функции \( f_2(x) = x^T A x \), где \( A \) — симметричная матрица, градиентом является \( 
abla f_2(x) = 2 A x \).

```{r}
# Определяем симметричную матрицу A и функцию f2
A <- matrix(c(1, 2, 2, 3), nrow = 2, byrow = TRUE) # пример матрицы A (2x2)
f2 <- function(x) {
  sum(x * (A %*% x))
}

# Вычисляем градиент функции f2
grad_f2 <- Deriv(f2, "x")
grad_f2
```

## Гессиан функции \( f_2(x) \)

Для функции \( f_2(x) = x^T A x \), гессиан является \( H(f_2) = 2A \), так как производная квадратичной формы по \( x \) — это симметричная матрица \( 2A \).

```{r}
# Гессиан функции f2
hessian_f2 <- 2 * A
hessian_f2
```

# Выводы

В результате мы получили следующие значения для функций \( f_1(x) \) и \( f_2(x) \):

1. Для линейной функции \( f_1(x) = a^T x \):
   - Градиент: \( a \)
   - Гессиан: нулевая матрица.

2. Для квадратичной функции \( f_2(x) = x^T A x \):
   - Градиент: \( 2 A x \)
   - Гессиан: \( 2 A \).
